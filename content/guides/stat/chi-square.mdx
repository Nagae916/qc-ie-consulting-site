---
title: "クロス集計とカイ二乗検定ガイド"
description: "クロス集計表の読み方から、期待度数・χ²計算までを整理しつつ、ページ内でインタラクティブに体験"
tags: ["統計", "カイ二乗検定", "クロス集計"]
exam: "stat"
slug: "chi-square"
status: "published"
date: "2025-09-17"
updatedAt: "2025-09-22"
---

# クロス集計とカイ二乗検定ガイド

2つのカテゴリ変数の関係（独立か関連があるか）を、**観測度数と期待度数の“ズレ”**で評価するのが **カイ二乗（χ²）検定** です。  
まずは下のウィジェットで **表を編集 → 期待度数 → χ²・df・p値** をその場で確認してください。

<ChiSquareGuide />

> 画面幅が狭い場合は横スクロールで表を操作できます。より広いキャンバスで試すなら  
> **インタラクティブ専用ページ**：[/tools/chi-square](/tools/chi-square)

---

## 1. クロス集計の基本

- **クロス集計表**：行＝カテゴリA、列＝カテゴリB の度数表。  
- **周辺度数**：各行・各列の合計。  
- **全体度数**：表全体の合計 \(N\)。

**期待度数（独立を仮定した基準）**  
行 \(i\)・列 \(j\) セルの期待度数 \(E_{ij}\) は

$$
E_{ij}=\frac{(\text{行}i\text{合計})\times(\text{列}j\text{合計})}{N}
$$

---

## 2. カイ二乗統計量と自由度

- **χ²統計量**

$$
\chi^2=\sum_{i}\sum_{j}\frac{(O_{ij}-E_{ij})^2}{E_{ij}}
$$

ここで \(O_{ij}\) は観測度数、\(E_{ij}\) は期待度数。

- **自由度（df）**

$$
\mathrm{df}=(\text{行数}-1)\times(\text{列数}-1)
$$

> **注意**：期待度数が極端に小さいセルが多いと近似の精度が低下します。カテゴリの再編や **フィッシャーの正確確率検定** の検討が必要です。

---

## 3. 検定の最短フロー

1. **クロス表を作成**（観測度数 \(O_{ij}\)）。  
2. **周辺度数**（各行・各列の合計）と **全体度数** \(N\) を計算。  
3. **期待度数** \(E_{ij}=\dfrac{(\text{行}i\text{合計})\times(\text{列}j\text{合計})}{N}\) を算出。  
4. **カイ二乗統計量** \( \chi^2=\sum_{i}\sum_{j}\dfrac{(O_{ij}-E_{ij})^2}{E_{ij}} \) と **自由度** \( \mathrm{df}=(\text{行数}-1)\times(\text{列数}-1) \) を計算し、**p値** を評価。  
5. **結論**：\(p<\alpha\) なら「**独立ではない（関連あり）**」、\(p\ge \alpha\) なら「**独立とみなす（関連は有意でない）**」。

### 実務メモ（報告の質を上げるために）

- **前提チェック**：期待度数が **5 未満** のセルが多いときは、カテゴリ再編や **フィッシャーの正確確率検定** を検討。  
- **2×2 の連続性補正（Yates）**：必要に応じて  
  \[
  \chi^2=\sum \frac{(|O_{ij}-E_{ij}|-0.5)^2}{E_{ij}}
  \]
  を併記し、採用有無を明示。  
- **効果量の報告**：関連の強さは **φ係数**（2×2：\(\displaystyle \varphi=\sqrt{\chi^2/N}\)）や **Cramér の V**（一般表：\(\displaystyle V=\sqrt{\chi^2/(N\cdot \min(r-1,c-1))}\)）で示す。  
- **報告テンプレ**：  
  「\(\chi^2(\mathrm{df}=\text{df}, N=\text{N})=\text{χ²値},\ p=\text{p値},\ V=\text{効果量}\)。  
  有意水準 \(\alpha=\text{0.05 等}\) で **（有意／非有意）**。解釈：…」

---
